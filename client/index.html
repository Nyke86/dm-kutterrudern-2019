<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deutsche Meisterschaft Kutterrudern 2019</title>

    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <div id="results">
        <h1 class="title">Deutsche Meisterschaft im Kutterrudern 2019</h1>
        <h2 class="title">5.000 Meter - Männer</h2>
        <hr/>
        <div class="legend"><div class="top-sector-time">Schnellste Sektorzeit</div><div class="top-time">Schnellste Zwischenzeit</div></div>
        <table>
            <thead>
                <td>#</td>
                <td>Team</td>
                <td>0,5 km</td>
                <td>1,0 km</td>
                <td>1,5 km</td>
                <td>2,0 km</td>
                <td>2,5 km</td>
                <td>3,0 km</td>
                <td>3,5 km</td>
                <td>4,0 km</td>
                <td>4,5 km</td>
                <td>5,0 km</td>
            </thead>
            <tbody>
                <tr class="boat_1"><td>01</td><td>SSC Rathenow</td><td class="top-sector-time">00:00:00</td><td>00:00:00</td><td class="top-sector-time top-time">00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_2"><td>02</td><td>SSC Wendisch-Rietz</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_3"><td>03</td><td>SSC Greifswald</td><td class="top-time">00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_4"><td>04</td><td>WSC Halle</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_5"><td>05</td><td>Anklamer Hanse-Haie</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_6"><td>06</td><td>Club Maritim Erfurt</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_7"><td>07</td><td>SSV Sömmerda</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_8"><td>08</td><td>Bernburger Maritimer Club</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
                <tr class="boat_9"><td>09</td><td>Leipziger Seesportclub e.V.</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td><td>00:00:00</td></tr>
            </tbody>
        </table>
        <hr/>
        <div class="legend"><div class="top-speed">Höchste Geschwindigkeit</div></div>
        <table>
            <thead>
                <tr>
                    <td rowspan="2">#</td>
                    <td rowspan="2">Team</td>
                    <td rowspan="2">Distanz</td>
                    <td rowspan="2">Zeit</td>
                    <td colspan="3">Geschwindigkeit</td>
                </tr>
                <tr>
                    <td>Aktuelle</td>
                    <td>&Oslash;</td>
                    <td>Höchste</td> 
                </tr>
            </thead>
            <tbody>
                <tr class="boat_1"><td>01</td><td>SSC Rathenow</td><td>2.356 m</td><td>00:15:00</td><td>8,32 km/h</td><td class="top-speed"><span class="arrow-down">&#x25BC;</span> 9,86 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_2"><td>02</td><td>SSC Wendisch-Rietz</td><td>2.356 m</td><td>00:15:00</td><td>10,32 km/h</td><td><span class="arrow-up">&#x25B2;</span> 9,84 km/h</td><td class="top-speed">10,96 km/h</td></tr>
                <tr class="boat_3"><td>03</td><td>SSC Greifswald</td><td>2.356 m</td><td>00:15:00</td><td>9,32 km/h</td><td><span class="arrow-down">&#x25BC;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_4"><td>04</td><td>WSC Halle</td><td>2.356 m</td><td>00:15:00</td><td class="top-speed">10,92 km/h</td><td><span class="arrow-up">&#x25B2;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_5"><td>05</td><td>Anklamer Hanse-Haie</td><td>2.356 m</td><td>00:15:00</td><td>8,32 km/h</td><td><span class="arrow-down">&#x25BC;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_6"><td>06</td><td>Club Maritim Erfurt</td><td>2.356 m</td><td>00:15:00</td><td>9,84 km/h</td><td><span class="circle">&#x25CF;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_7"><td>07</td><td>SSV Sömmerda</td><td>2.356 m</td><td>00:15:00</td><td>10,32 km/h</td><td><span class="arrow-up">&#x25B2;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_8"><td>08</td><td>Bernburger Maritimer Club</td><td>2.356 m</td><td>00:15:00</td><td>10,32 km/h</td><td><span class="arrow-up">&#x25B2;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
                <tr class="boat_9"><td>09</td><td>Leipziger Seesportclub e.V.</td><td>2.356 m</td><td>00:15:00</td><td>10,32 km/h</td><td><span class="arrow-up">&#x25B2;</span> 9,84 km/h</td><td>10,86 km/h</td></tr>
            </tbody>
        </table>
    </div>
    <script>
        var map;
        var markerList = [];
        var activeInfoWindow = undefined;
        var activeMarkerIndex = 0;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 52.598, lng: 12.326},
                zoom: 15,
                gestureHandling: 'none',
                zoomControl: false,
                mapTypeControl: false,
                scaleControl: false,
                streetViewControl: false,
                rotateControl: false,
                fullscreenControl: false,
                styles: [
                {
                  "featureType": "administrative.land_parcel",
                  "elementType": "labels",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "administrative.locality",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "administrative.neighborhood",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "landscape.man_made",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "landscape.natural",
                  "stylers": [
                    {
                      "visibility": "on"
                    }
                  ]
                },
                {
                  "featureType": "landscape.natural.landcover",
                  "stylers": [
                    {
                      "visibility": "on"
                    }
                  ]
                },
                {
                  "featureType": "landscape.natural.terrain",
                  "stylers": [
                    {
                      "visibility": "on"
                    }
                  ]
                },
                {
                  "featureType": "poi",
                  "elementType": "labels.text",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.attraction",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.business",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.business",
                  "elementType": "labels",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.government",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.medical",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.school",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "poi.sports_complex",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "road.arterial",
                  "elementType": "labels.icon",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "road.arterial",
                  "elementType": "labels.text",
                  "stylers": [
                    {
                      "visibility": "on"
                    }
                  ]
                },
                {
                  "featureType": "road.highway",
                  "elementType": "labels.icon",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "road.local",
                  "elementType": "labels",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "road.local",
                  "elementType": "labels.icon",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "road.local",
                  "elementType": "labels.text",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "transit.line",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "transit.station",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "water",
                  "elementType": "labels.icon",
                  "stylers": [
                    {
                      "visibility": "off"
                    }
                  ]
                },
                {
                  "featureType": "water",
                  "elementType": "labels.text",
                  "stylers": [
                    {
                      "visibility": "simplified"
                    }
                  ]
                }
              ]
            });

            addMarker({lat: 52.592840, lng: 12.325924}, "5", "Anklamer Hanse-Haie", map);
            addMarker({lat: 52.594237, lng: 12.321337}, "4", "WSC Halle", map);
            addMarker({lat: 52.600430, lng: 12.315769}, "3", "SSC Greifswald", map);
            addMarker({lat: 52.601890, lng: 12.326153}, "2", "SSC Wendisch-Rietz", map);
            addMarker({lat: 52.604466, lng: 12.328650}, "1", "SSC Rathenow", map);

            showInfoWindow();

            window.setInterval(showInfoWindow, 5*1000);
        }

        function addMarker(location, team_nr, team_name, map) {
            var marker = new google.maps.Marker({
                position: location,
                label: team_nr,
                map: map
            });

            markerList.push({
                marker: marker,
                boat_number: team_nr,
                name: team_name
            });
        }

        function showInfoWindow() {
            if (activeInfoWindow) { activeInfoWindow.close();}

            var highlightedElements = Array.from(document.querySelectorAll(".highlight"));
            for(let index in highlightedElements){
                highlightedElements[index].classList.remove('highlight');
            }

            let marker_data = markerList[activeMarkerIndex];

            var elements = Array.from(document.querySelectorAll(".boat_" + marker_data.boat_number));
            for(let index in elements){
                elements[index].classList.add('highlight');
            }

            let infowindow = new google.maps.InfoWindow({
                content: marker_data.name
            });

            infowindow.open(map, marker_data.marker);

            activeInfoWindow = infowindow;
            activeMarkerIndex =  (activeMarkerIndex + 1) % markerList.length;
        }

        var socket = io();
        var session_id = 1;

        socket.on('cutter.race.info', function(msg) {
          console.log(msg);
        });

        socket.on('cutter.race.feed.split_times', function(msg) {
          console.log(msg);
        });

        socket.on('cutter.race.feed.live_data', function(msg) {
          console.log(msg);
        });

        socket.emit('cutter.race.init', session_id);
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDdzshFeTbKPh6syJU6JGQ0ETa23POnCg&callback=initMap" async defer></script>
  </body>
</html>